version: '3.8'
services:
  sqsproxyd:
    image: sqsproxyd
    build:
      context: .
      dockerfile: docker/Dockerfile
      target: sqsproxyd
    env_file:
      - env/container.env
    depends_on:
      - sqsproxyd-api
      - sqsproxyd-sqs
  builder:
    image: sqsproxyd:builder
    build:
      context: .
      dockerfile: docker/Dockerfile
      target: builder
  release-builder:
    image: sqsproxyd:release-builder
    build:
      context: .
      dockerfile: docker/Dockerfile
      target: release-builder
  dev:
    image: sqsproxyd:dev
    build:
      context: .
      dockerfile: docker/Dockerfile
      target: dev
    volumes:
      - .:/usr/src/sqsproxyd
    command: bash
    tty: true
    depends_on:
      - sqsproxyd-api
      - sqsproxyd-sqs
  sqsproxyd-api:
    image: ealen/echo-server:latest
    ports:
      - "4000:80"
  sqsproxyd-sqs:
    image: roribio16/alpine-sqs:latest
    ports:
      - "9324:9324"
      - "9325:9325"
    volumes:
      - ./docker/sqs:/opt/custom
